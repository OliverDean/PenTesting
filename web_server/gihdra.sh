# Description: This script installs Ghidra on a Linux system.
echo "Installing Ghidra..."

apt-get install -y default-jre
apt-get install -y wget
apt-get install -y unzip

# Define Ghidra version and download URL
GHIDRA_VERSION="10.3.1_PUBLIC"  # Update this to the latest version if necessary
GHIDRA_DOWNLOAD_URL="https://github.com/NationalSecurityAgency/ghidra/releases/download/Ghidra_${GHIDRA_VERSION}/ghidra_${GHIDRA_VERSION}_build.zip"
GHIDRA_INSTALL_DIR="/Desktop/ghidra"

# Create installation directory
echo "Creating Ghidra installation directory..."
mkdir -p "$GHIDRA_INSTALL_DIR"

# Download Ghidra
echo "Downloading Ghidra..."
wget -O /tmp/ghidra.zip "$GHIDRA_DOWNLOAD_URL"

# Unzip Ghidra
echo "Unzipping Ghidra..."
unzip /tmp/ghidra.zip -d "$GHIDRA_INSTALL_DIR"

# Remove the zip file to clean up
echo "Cleaning up Ghidra installation files..."
rm /tmp/ghidra.zip

# Create a symbolic link for easier access
echo "Creating symbolic link for Ghidra..."
ln -s "$GHIDRA_INSTALL_DIR/ghidra_${GHIDRA_VERSION}" "$GHIDRA_INSTALL_DIR/ghidra"

# Set permissions to allow the original user to access Ghidra
echo "Setting permissions for Ghidra directory..."
chown -R "$ORIGINAL_USER:$ORIGINAL_USER" "$GHIDRA_INSTALL_DIR"

# Add Ghidra to PATH (optional)
echo "Adding Ghidra to PATH in .bashrc..."
echo "export PATH=\$PATH:$GHIDRA_INSTALL_DIR/ghidra" >> "/home/$ORIGINAL_USER/.bashrc"
